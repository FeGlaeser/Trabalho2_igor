<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Venda de Ingressos - Cinema System</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="container">
        <h1>ğŸŸï¸ Terminal de Vendas</h1>
        
        <h2>Venda RÃ¡pida de Ingresso</h2>
        <form id="formVenda">
            <label for="sessao_id">ID da SessÃ£o:</label>
            <input type="number" id="sessao_id" name="sessao_id" value="1" required>
            
            <label for="num_assento">NÃºmero do Assento (1, 2, 3...):</label>
            <input type="number" id="num_assento" name="num_assento" value="1" required>
            
            <button type="submit">Vender Ingresso</button>
        </form>

        <div id="resultado">Aguardando venda...</div>
    </div>

    <script>
        document.getElementById('formVenda').addEventListener('submit', function(e) {
            e.preventDefault();

            const sessaoId = document.getElementById('sessao_id').value;
            const numAssento = document.getElementById('num_assento').value;
            const resultadoDiv = document.getElementById('resultado');

            const data = new URLSearchParams();
            data.append('sessao_id', sessaoId);
            data.append('num_assento', numAssento);
            
            resultadoDiv.className = '';
            resultadoDiv.innerHTML = 'Processando...';

            fetch('/api/ingressos/vender', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: data
            })
            .then(response => response.text())
            .then(text => {
                resultadoDiv.innerHTML = text;
                if (text.startsWith("Sucesso")) {
                    resultadoDiv.classList.add('sucesso');
                } else {
                    resultadoDiv.classList.add('erro');
                }
            })
            .catch(error => {
                resultadoDiv.innerHTML = 'Erro de comunicaÃ§Ã£o com o servidor.';
                resultadoDiv.classList.add('erro');
                console.error('Erro:', error);
            });
        });
    </script>
</body>
</html>